import{Fragment as H,computed as f,defineComponent as S,h as T,inject as j,onMounted as K,onUnmounted as M,provide as N,ref as y,toRaw as m}from"vue";import{dom as V}from"../../utils/dom.js";import{Keys as R}from"../../keyboard.js";import{focusIn as A,Focus as O,FocusResult as D,sortByDomNode as $}from"../../utils/focus-management.js";import{useId as F}from"../../hooks/use-id.js";import{compact as U,omit as _,render as L}from"../../utils/render.js";import{Label as W,useLabels as C}from"../label/label.js";import{Description as z,useDescriptions as x}from"../description/description.js";import{useTreeWalker as J}from"../../hooks/use-tree-walker.js";import{Hidden as q,Features as Q}from"../../internal/hidden.js";import{attemptSubmit as X,objectToFormEntries as Y}from"../../utils/form.js";import{getOwnerDocument as G}from"../../utils/owner.js";let I=Symbol("RadioGroupContext");function P(o){let b=j(I,null);if(b===null){let l=new Error(`<${o} /> is missing a parent <RadioGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,P),l}return b}let ve=S({name:"RadioGroup",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"div"},disabled:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean]},name:{type:String,optional:!0}},inheritAttrs:!1,setup(o,{emit:b,attrs:l,slots:h,expose:s}){let u=y(null),n=y([]),k=C({name:"RadioGroupLabel"}),v=x({name:"RadioGroupDescription"});s({el:u,$el:u});let g=f(()=>o.modelValue),d={options:n,value:g,disabled:f(()=>o.disabled),firstOption:f(()=>n.value.find(e=>!e.propsRef.disabled)),containsCheckedOption:f(()=>n.value.some(e=>d.compare(m(e.propsRef.value),m(o.modelValue)))),compare(e,a){return e===a},change(e){var t;if(o.disabled||d.compare(m(g.value),m(e)))return!1;let a=(t=n.value.find(i=>d.compare(m(i.propsRef.value),m(e))))==null?void 0:t.propsRef;return a!=null&&a.disabled?!1:(b("update:modelValue",e),!0)},registerOption(e){n.value.push(e),n.value=$(n.value,a=>a.element)},unregisterOption(e){let a=n.value.findIndex(t=>t.id===e);a!==-1&&n.value.splice(a,1)}};N(I,d),J({container:f(()=>V(u)),accept(e){return e.getAttribute("role")==="radio"?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(e){e.setAttribute("role","none")}});function E(e){if(!u.value||!u.value.contains(e.target))return;let a=n.value.filter(t=>t.propsRef.disabled===!1).map(t=>t.element);switch(e.key){case R.Enter:X(e.currentTarget);break;case R.ArrowLeft:case R.ArrowUp:if(e.preventDefault(),e.stopPropagation(),A(a,O.Previous|O.WrapAround)===D.Success){let i=n.value.find(p=>{var r;return p.element===((r=G(u))==null?void 0:r.activeElement)});i&&d.change(i.propsRef.value)}break;case R.ArrowRight:case R.ArrowDown:if(e.preventDefault(),e.stopPropagation(),A(a,O.Next|O.WrapAround)===D.Success){let i=n.value.find(p=>{var r;return p.element===((r=G(p.element))==null?void 0:r.activeElement)});i&&d.change(i.propsRef.value)}break;case R.Space:{e.preventDefault(),e.stopPropagation();let t=n.value.find(i=>{var p;return i.element===((p=G(i.element))==null?void 0:p.activeElement)});t&&d.change(t.propsRef.value)}break}}let c=`headlessui-radiogroup-${F()}`;return()=>{let{modelValue:e,disabled:a,name:t,...i}=o,p={ref:u,id:c,role:"radiogroup","aria-labelledby":k.value,"aria-describedby":v.value,onKeydown:E};return T(H,[...t!=null&&e!=null?Y({[t]:e}).map(([r,w])=>T(q,U({features:Q.Hidden,key:r,as:"input",type:"hidden",hidden:!0,readOnly:!0,name:r,value:w}))):[],L({ourProps:p,theirProps:{...l,...i},slot:{},attrs:l,slots:h,name:"RadioGroup"})])}}});var Z=(l=>(l[l.Empty=1]="Empty",l[l.Active=2]="Active",l))(Z||{});let be=S({name:"RadioGroupOption",props:{as:{type:[Object,String],default:"div"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(o,{attrs:b,slots:l,expose:h}){let s=P("RadioGroupOption"),u=`headlessui-radiogroup-option-${F()}`,n=C({name:"RadioGroupLabel"}),k=x({name:"RadioGroupDescription"}),v=y(null),g=f(()=>({value:o.value,disabled:o.disabled})),d=y(1);h({el:v,$el:v}),K(()=>s.registerOption({id:u,element:v,propsRef:g})),M(()=>s.unregisterOption(u));let E=f(()=>{var r;return((r=s.firstOption.value)==null?void 0:r.id)===u}),c=f(()=>s.disabled.value||o.disabled),e=f(()=>s.compare(m(s.value.value),m(o.value))),a=f(()=>c.value?-1:e.value||!s.containsCheckedOption.value&&E.value?0:-1);function t(){var r;!s.change(o.value)||(d.value|=2,(r=v.value)==null||r.focus())}function i(){d.value|=2}function p(){d.value&=-3}return()=>{let r=_(o,["value","disabled"]),w={checked:e.value,disabled:c.value,active:Boolean(d.value&2)},B={id:u,ref:v,role:"radio","aria-checked":e.value?"true":"false","aria-labelledby":n.value,"aria-describedby":k.value,"aria-disabled":c.value?!0:void 0,tabIndex:a.value,onClick:c.value?void 0:t,onFocus:c.value?void 0:i,onBlur:c.value?void 0:p};return L({ourProps:B,theirProps:r,slot:w,attrs:b,slots:l,name:"RadioGroupOption"})}}}),Re=W,ge=z;export{ve as RadioGroup,ge as RadioGroupDescription,Re as RadioGroupLabel,be as RadioGroupOption};
